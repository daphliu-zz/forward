{"version":3,"file":"idb-keyval.js","sources":["../node_modules/idb-keyval/dist/idb-keyval.mjs"],"sourcesContent":["class Store {\r\n    constructor(dbName = 'keyval-store', storeName = 'keyval') {\r\n        this.storeName = storeName;\r\n        this._dbp = new Promise((resolve, reject) => {\r\n            const openreq = indexedDB.open(dbName, 1);\r\n            openreq.onerror = () => reject(openreq.error);\r\n            openreq.onsuccess = () => resolve(openreq.result);\r\n            // First time setup: create an empty object store\r\n            openreq.onupgradeneeded = () => {\r\n                openreq.result.createObjectStore(storeName);\r\n            };\r\n        });\r\n    }\r\n    _withIDBStore(type, callback) {\r\n        return this._dbp.then(db => new Promise((resolve, reject) => {\r\n            const transaction = db.transaction(this.storeName, type);\r\n            transaction.oncomplete = () => resolve();\r\n            transaction.onabort = transaction.onerror = () => reject(transaction.error);\r\n            callback(transaction.objectStore(this.storeName));\r\n        }));\r\n    }\r\n}\r\nlet store;\r\nfunction getDefaultStore() {\r\n    if (!store)\r\n        store = new Store();\r\n    return store;\r\n}\r\nfunction get(key, store = getDefaultStore()) {\r\n    let req;\r\n    return store._withIDBStore('readonly', store => {\r\n        req = store.get(key);\r\n    }).then(() => req.result);\r\n}\r\nfunction set(key, value, store = getDefaultStore()) {\r\n    return store._withIDBStore('readwrite', store => {\r\n        store.put(value, key);\r\n    });\r\n}\r\nfunction del(key, store = getDefaultStore()) {\r\n    return store._withIDBStore('readwrite', store => {\r\n        store.delete(key);\r\n    });\r\n}\r\nfunction clear(store = getDefaultStore()) {\r\n    return store._withIDBStore('readwrite', store => {\r\n        store.clear();\r\n    });\r\n}\r\nfunction keys(store = getDefaultStore()) {\r\n    const keys = [];\r\n    return store._withIDBStore('readonly', store => {\r\n        // This would be store.getAllKeys(), but it isn't supported by Edge or Safari.\r\n        // And openKeyCursor isn't supported by Safari.\r\n        (store.openKeyCursor || store.openCursor).call(store).onsuccess = function () {\r\n            if (!this.result)\r\n                return;\r\n            keys.push(this.result.key);\r\n            this.result.continue();\r\n        };\r\n    }).then(() => keys);\r\n}\n\nexport { Store, get, set, del, clear, keys };\n"],"names":[],"mappings":"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"}